/*
@title: Falling Water
@author: Captainexpo
*/
const sand = "s";
const wall = "w";
let speed = "100"
setLegend(
  [ sand, bitmap`
7555555555555557
5555555555555555
5555555555555555
5555555555555555
5555555555555555
5555555555555555
5555555555555555
5555555555555555
5555555555555555
5555555555555555
5555555555555555
5555555555555555
5555555555555555
5555555555555555
5555555555555555
7555555555555557`,],
  [ wall, bitmap`
0000000000000000
0200000022220020
000LL02222000000
0000000000000L00
0L00000000000000
00000L00L0200000
0200020000000002
02000000000000L2
00L0000000L20200
020000L0000000L0
002000000L002022
002L00000L220000
0000000000020000
L00200000000000L
200000L02000L000
0000000000000000`,]
);

let level = 0;
const levels = [
  map`
.........................
.........................
.........................
.........................
.........................
.........................
.........................
.........................
.........................
.........................
.........................
.........................
.........................
.........................
.........................
.........................
.........................
.........................
.........................
.........................
.........................
.........................
.........................
.........................`,
  map`
...................................
...................................
...................................
...................................
...................................
...................................
...................................
...................................
...................................
...................................
...................................
...................................
...................................
...................................
...................................
...................................
...................................
...................................
...................................
...................................
...................................
...................................
...................................
...................................
...................................
...................................
...................................
...................................
...................................
...................................
...................................
...................................
...................................
...................................`,
];
addText("use WASD", {x: 6, y: 7, color: [0,0,0]})
addText("to spawn water.", {x: 3, y: 8, color: [0,0,0]})
setPushables({
  [ sand ]: [],
});
const currentLevel = levels[0];
setMap(currentLevel);

setSolids([ sand]);
Update()
onInput("s", () => {
  clearText()
  addSprite(15, 0, sand);
});
onInput("w", () => {
  clearText()
  addSprite(10, 0, sand);
});
onInput("a", () => {
  clearText()
  addSprite(5, 0, sand);
});
onInput("d", () => {
  clearText
  addSprite(20, 0, sand);
});
onInput("j", () => {
  setMap(levels[0])
});
onInput("l", () => {
  setMap(levels[1])
});
function Update(){
    getAll(sand).forEach((w) => { 
      getAll(sand).forEach((x)=> {
                if (w.x == x.x && w.y == x.y-1) {
          if(Math.random() > 0.5){
            w.x += 1; 
          }
          else{
            w.x -= 1; 
          }
        }  
      });
      w.y += 1;
  });
  setTimeout(Update, speed);

}
 


